# 内存分配原理



参考CSAPP



## 存储器层次结构

### 局部性

> 时间：被引用过一次的内存位置很可能在将来被继续引用
>
> 空间：一个位置被引用了，将来可能会引用附近的位置
>
> 重复引用相同变量局部性好
>
> 步长越小，空间局部性越好
>
> 循环体越小，循环次数越多，局部性越好

### 存储器层次结构

> | 寄存器           k  0 |
> | --------------------- |
> | L1缓存           k  1 |
> | L2缓存           k  2 |
> | L3缓存                |
> | DRAM                  |
> | 本地磁盘              |
> | 远程存储              |
>
> 核心思想：
>
> 1，每一层都缓存来自较低一层的数据对象。
>
> 2，数据总是以块为单元在k和k+1层进行传送，k越大，块越大。
>
> 大多数时候缓存都是自动运行

> 缓存命中：
>
> 第k层存储了想要访问的数据，则直接从k层读取
>
> 缓存不命中：
>
> 从第k+1层取出要访问的对象放入第k层，k满了则会覆盖。然后再从k层读取。

> 冷缓存：
>
> 第k层缓存为空，对所有数据对象的访问都不会命中。此类不命中又称冷不命中
>
> 工作集：
>
> 每个阶段访问缓存块的某个相对稳定的集合。

> 